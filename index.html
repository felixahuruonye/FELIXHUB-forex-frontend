<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FELIXHUB Forex Time Zone</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #f3f7fa;
      color: #333;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    header {
      background: #004aad;
      color: white;
      padding: 1rem 0;
      font-size: 1.5rem;
      font-weight: bold;
      text-transform: uppercase;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .container {
      max-width: 600px;
      margin: 30px auto;
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    input, select, button {
      padding: 10px;
      margin: 8px;
      width: 90%;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      background-color: #004aad;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover { background-color: #003580; }

    .result-card {
      background: #f1f5ff;
      padding: 12px;
      border-radius: 8px;
      margin-top: 10px;
      border-left: 5px solid #004aad;
    }

    .premium-box {
      background: #e9f9ec;
      border: 1px solid #00964d;
      border-left: 5px solid #00964d;
      padding: 15px;
      margin-top: 15px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <header>üåç FELIXHUB Forex Time Zone</header>

  <div class="container">
    <h3>Check Real-Time for Any Country</h3>

    <div id="countryFormContainer">
      <div class="country-box">
        <select class="continent">
          <option value="">Select Continent</option>
          <option>Africa</option>
          <option>Asia</option>
          <option>Europe</option>
          <option>North America</option>
          <option>South America</option>
          <option>Oceania</option>
        </select>
        <input type="text" placeholder="Country (e.g. Nigeria)" class="country" />
        <input type="text" placeholder="City (e.g. Owerri)" class="city" />
      </div>
    </div>

    <button id="addCountry">+ Add Another Country</button>
    <button id="getTime">Get Time</button>
    <button id="useMyIP">Use My IP</button>

    <div id="results"></div>

    <div id="premiumPrompt" class="premium-box" style="display:none;">
      <h4>Upgrade to Premium üåü</h4>
      <p>Unlock more continents, zip codes, and forex tools by subscribing!</p>
      <a id="paystackLink" href="https://paystack.com/pay/felixhub-forex-sub" target="_blank">
        <button>Upgrade with Paystack</button>
      </a>
    </div>
  </div>

  <script>
    const backendUrl = "https://felixhub-forex-backend.onrender.com";
    const resultsDiv = document.getElementById("results");
    const addCountryBtn = document.getElementById("addCountry");
    const getTimeBtn = document.getElementById("getTime");
    const useMyIPBtn = document.getElementById("useMyIP");
    const premiumPrompt = document.getElementById("premiumPrompt");
    let searchCount = 0;

    // Add extra country fields
    addCountryBtn.addEventListener("click", () => {
      const container = document.createElement("div");
      container.classList.add("country-box");
      container.innerHTML = `
        <select class="continent">
          <option value="">Select Continent</option>
          <option>Africa</option>
          <option>Asia</option>
          <option>Europe</option>
          <option>North America</option>
          <option>South America</option>
          <option>Oceania</option>
        </select>
        <input type="text" placeholder="Country (e.g. USA)" class="country" />
        <input type="text" placeholder="City (e.g. New York)" class="city" />
      `;
      document.getElementById("countryFormContainer").appendChild(container);
    });

    // Get real time by country/city
    getTimeBtn.addEventListener("click", async () => {
      const boxes = document.querySelectorAll(".country-box");
      resultsDiv.innerHTML = "";
      searchCount++;

      if (searchCount > 20) {
        premiumPrompt.style.display = "block";
        return;
      }

      for (let box of boxes) {
        const country = box.querySelector(".country").value.trim();
        const city = box.querySelector(".city").value.trim();
        if (!country || !city) continue;

        try {
          const query = `${city},${country}`;
          const res = await fetch(`${backendUrl}/get-time?location=${encodeURIComponent(query)}`);
          const data = await res.json();

          if (!data.datetime) {
            resultsDiv.innerHTML += `<div class="result-card">‚ùå Could not get time for ${city}, ${country}</div>`;
            continue;
          }

          resultsDiv.innerHTML += `
            <div class="result-card">
              <strong>${city}, ${country}</strong><br>
              Timezone: ${data.timezone}<br>
              Local Time: ${new Date(data.datetime).toLocaleString()}
            </div>
          `;
        } catch (err) {
          resultsDiv.innerHTML += `<div class="result-card">‚ö†Ô∏è Error fetching time for ${city}, ${country}</div>`;
        }
      }
    });

    // Use My IP
    useMyIPBtn.addEventListener("click", async () => {
      resultsDiv.innerHTML = "<p>Loading your IP info...</p>";
      try {
        const response = await fetch(`${backendUrl}/ipinfo`);
        const data = await response.json();

        resultsDiv.innerHTML = `
          <div class="result-card">
            <strong>Your IP:</strong> ${data.ip}<br>
            <strong>City:</strong> ${data.city}<br>
            <strong>Country:</strong> ${data.country_name}<br>
            <strong>Time Zone:</strong> ${data.timezone}<br>
            <strong>Local Time:</strong> ${new Date().toLocaleString("en-US", { timeZone: data.timezone })}
          </div>
        `;
      } catch (err) {
        resultsDiv.innerHTML = `<div class="result-card">‚ö†Ô∏è Could not fetch your IP info</div>`;
      }
    });
  </script>
</body>
</html>
